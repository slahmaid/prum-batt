<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Prumysl - بطاريات الشوفو القابلة للشحن</title>
    
    <meta name="description" content="بطاريات Type-D كبيرة قابلة للشحن لسخان الماء. شرارة قوية وتوفير دائم. توصيل مجاني في المغرب.">
    
    <link rel="preload" as="image" href="img/Hero.jpg">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri+Quran&family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

    <style>
        /* --- CSS VARIABLES --- */
        :root {
            --primary-color: #000000;
            --secondary-color: #ffffff;
            --accent-color: #d32f2f;
            --success-color: #27ae60;
            --bg-color: #f4f6f8; 
            --text-color: #333333;
            --whatsapp-color: #25D366;
            --font-heading: 'Amiri Quran', serif;
            --font-body: 'Tajawal', sans-serif;
            --border-radius: 12px;
            --shadow-card: 0 4px 20px rgba(0,0,0,0.06);
        }

        /* --- GLOBAL RESET & TYPOGRAPHY --- */
        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: var(--font-body);
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow-x: hidden;
            line-height: 1.6;
            padding-bottom: 80px; /* Reserve space for mobile bar */
        }

        h1, h2, h3, .hero-title, .section-title { font-family: var(--font-heading); }
        
        a { text-decoration: none; color: inherit; }
        img { max-width: 100%; display: block; }
        html { scroll-behavior: smooth; scroll-padding-top: 20px; }

        /* --- HEADER --- */
        .site-header { background-color: var(--secondary-color); height: 60px; width: 100%; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 1000; }
        .header-content { max-width: 1200px; margin: 0 auto; height: 100%; padding: 0 20px; display: flex; align-items: center; justify-content: space-between; }
        .logo img { max-height: 40px; width: auto; }
        
        .header-cta { background-color: var(--primary-color); color: var(--secondary-color); padding: 8px 20px; font-size: 15px; border-radius: 8px; font-weight: 700; }
        @media (max-width: 768px) { .header-cta { display: none; } }

        /* --- HERO SECTION --- */
        .hero-section { 
            position: relative; 
            height: 75vh; 
            min-height: 500px; 
            width: 100%; 
            background-image: url('img/Hero.jpg'); 
            background-size: cover; 
            background-position: center; 
            display: flex; align-items: center; 
        }
        .hero-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(90deg, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0.7) 100%); z-index: 1; }
        .hero-content { position: relative; z-index: 2; max-width: 600px; padding: 0 20px; color: #fff; text-align: center; margin: 0 auto; }
        .hero-title { font-size: 40px; line-height: 1.3; margin-bottom: 15px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .hero-subtitle { font-size: 18px; margin-bottom: 25px; font-weight: 500; opacity: 0.95; }
        .hero-cta { 
            background-color: #fff; color: #000; 
            padding: 16px 45px; font-size: 18px; 
            border-radius: 50px; font-weight: 800; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); display: inline-block; 
        }

        /* --- SECTIONS GENERAL --- */
        section { padding: 40px 15px; }
        .container { max-width: 1100px; margin: 0 auto; }
        .section-header-center { text-align: center; margin-bottom: 30px; }
        .section-header-center h2 { font-size: 28px; color: var(--primary-color); position: relative; display: inline-block; }

        /* --- FEATURES --- */
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .feature-card { 
            background: #fff; padding: 25px; text-align: center; 
            border-radius: var(--border-radius); 
            box-shadow: var(--shadow-card); 
        }
        .feature-icon { width: 50px; height: 50px; margin-bottom: 15px; fill: var(--primary-color); }
        .feature-title { font-size: 20px; margin-bottom: 10px; font-family: var(--font-heading); }
        
        /* --- MOBILE SCROLL SNAP --- */
        @media (max-width: 768px) {
            .mobile-scroll-container {
                display: flex;
                overflow-x: auto;
                scroll-snap-type: x mandatory;
                gap: 15px;
                padding-bottom: 20px;
                margin: 0 -15px;
                padding-left: 15px; padding-right: 15px;
                -webkit-overflow-scrolling: touch;
            }
            .mobile-scroll-container::-webkit-scrollbar { display: none; }
            .mobile-scroll-item {
                flex: 0 0 85%;
                scroll-snap-align: center;
                width: 85%;
            }
        }
        
        @media (min-width: 769px) {
            .gallery-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; }
            .reviews-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        }

        /* --- GALLERY --- */
        .gallery-item { border-radius: 12px; overflow: hidden; box-shadow: var(--shadow-card); aspect-ratio: 1/1; }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; }

        /* --- REVIEWS --- */
        .review-card { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); height: 100%; border: 1px solid #eee; }
        .stars { color: #f1c40f; margin-bottom: 10px; letter-spacing: 2px; }
        .review-text { font-size: 15px; margin-bottom: 15px; color: #555; }
        .reviewer-info { display: flex; align-items: center; border-top: 1px solid #f0f0f0; padding-top: 12px; }
        .avatar-circle { width: 40px; height: 40px; background: #333; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-left: 12px; font-weight: bold; flex-shrink: 0; }
        
        /* TRUST SIGNALS: Verified Badge */
        .verified-badge {
            font-size: 11px;
            color: #27ae60;
            background: #e8f8f0;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-block;
            margin-top: 2px;
        }

        /* --- COMPARISON TABLE --- */
        .comparison-table { width: 100%; background: #fff; border-radius: 12px; overflow: hidden; box-shadow: var(--shadow-card); border-collapse: collapse; }
        .comparison-table th, .comparison-table td { padding: 15px; text-align: center; border-bottom: 1px solid #eee; font-size: 15px; }
        .col-us { background: #fdfdfd; font-weight: 700; color: var(--success-color); border-left: 2px solid #eee; border-right: 2px solid #eee; }
        th.col-us { background: var(--primary-color); color: #fff; border:none;}

        /* --- FOMO SECTION --- */
        .fomo-section { background: #fff5f5; text-align: center; border-top: 1px solid #ffdcdc; border-bottom: 1px solid #ffdcdc; }
        .countdown-timer { display: flex; justify-content: center; gap: 10px; margin: 15px 0; }
        .time-block { background: #fff; padding: 5px 10px; border-radius: 6px; border: 1px solid #ffcccc; min-width: 60px; }
        .time-number { display: block; font-weight: 800; font-size: 20px; color: var(--accent-color); font-family: sans-serif; }
        
        /* --- ORDER FORM --- */
        .form-container { 
            max-width: 500px; margin: 0 auto; 
            background: #fff; padding: 30px 20px; 
            border-radius: 16px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.08); 
        }
        .form-group { margin-bottom: 20px; text-align: right; }
        .form-label { display: block; margin-bottom: 8px; font-weight: 700; font-size: 14px; }
        .form-input { 
            width: 100%; padding: 16px; 
            font-size: 16px; border: 2px solid #eee; border-radius: 10px; 
            font-family: var(--font-body); background: #fcfcfc;
            scroll-margin-top: 100px; 
        }
        .form-input:focus { border-color: var(--primary-color); background: #fff; }

        .offer-options { display: flex; flex-direction: column; gap: 15px; margin-bottom: 25px; }
        .offer-card { position: relative; }
        .offer-card input { display: none; }
        .offer-label {
            display: flex; justify-content: space-between; align-items: center;
            padding: 18px; border: 2px solid #eee; border-radius: 12px;
            cursor: pointer; transition: all 0.2s; background: #fff;
        }
        .offer-card input:checked + .offer-label {
            border-color: var(--success-color);
            background-color: #f0fff4;
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.15);
        }
        .offer-card input:checked + .offer-label .price-text { color: var(--success-color); }
        .price-text { font-weight: 800; font-size: 18px; font-family: sans-serif; dir: ltr; }

        .submit-btn {
            width: 100%; padding: 18px;
            background: var(--primary-color); color: #fff;
            font-size: 20px; font-weight: 800; border: none; border-radius: 10px;
            cursor: pointer; font-family: var(--font-body);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* --- FOOTER --- */
        .site-footer { background: #111; color: #888; padding: 40px 20px 20px; text-align: center; font-size: 14px; }

        /* --- SMART MOBILE STICKY BAR --- */
        .mobile-sticky-bar { 
            position: fixed; bottom: 0; left: 0; width: 100%; 
            background: #fff; padding: 12px 15px; 
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1); 
            z-index: 999; border-top: 1px solid #f0f0f0;
            transform: translateY(100%); 
            transition: transform 0.3s ease-out;
            padding-bottom: max(12px, env(safe-area-inset-bottom));
        }
        .mobile-sticky-bar.visible { transform: translateY(0); }
        
        .mobile-sticky-btn { 
            display: block; width: 100%; 
            background: var(--primary-color); color: #fff; 
            text-align: center; padding: 14px; border-radius: 50px; 
            font-size: 18px; font-weight: 800; 
            position: relative; overflow: hidden;
        }
        
        .mobile-sticky-btn::after {
            content: ''; position: absolute; top: 0; left: -100%;
            width: 50%; height: 100%;
            background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0) 100%);
            animation: shimmer 3s infinite;
        }
        @keyframes shimmer { 0% { left: -100%; } 20% { left: 200%; } 100% { left: 200%; } }

        /* --- WHATSAPP --- */
        .whatsapp-float { 
            position: fixed; bottom: 85px; right: 20px; 
            width: 55px; height: 55px; background: var(--whatsapp-color); 
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 1000;
        }
        .whatsapp-float svg { width: 30px; fill: #fff; }

        /* --- KEYBOARD SAFETY LOGIC --- */
        /* Hides sticky elements when keyboard is open (screen height shrinks) */
        @media screen and (max-height: 500px) {
            .mobile-sticky-bar, .whatsapp-float { display: none !important; }
        }

    </style>
</head>
<body>

    <header class="site-header">
        <div class="header-content">
            <a href="#" class="logo"><img src="img/prumysl logo.png" alt="Prumysl"></a>
            <a href="#order" class="header-cta">اطلب الآن</a>
        </div>
    </header>

    <section class="hero-section" id="hero">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h1 class="hero-title">الماء سخون ديما<br>وبأقل تكلفة!</h1>
            <p class="hero-subtitle">بطاريات كبيرة (Type D) لسخان الماء: شرارة قوية، تدوم طويلاً، وقابلة للشحن.</p>
            <a href="#order" class="hero-cta">اطلبها الآن</a>
        </div>
    </section>

    <section class="order-section" style="background: #fff;">
        <div class="container">
            <div class="form-container">
                <div class="section-header-center" style="margin-bottom: 20px;">
                    <h2>استفد من العرض الحصري</h2>
                </div>
                <form id="topOrderForm" action="#" method="POST">
                    <div class="offer-options">
                        <div class="offer-card">
                            <input type="radio" name="offer-top" id="top-offer1" value="149" checked>
                            <label for="top-offer1" class="offer-label">
                                <span>علبة واحدة (2 حبات)</span>
                                <span class="price-text">149 DH</span>
                            </label>
                        </div>
                        <div class="offer-card">
                            <input type="radio" name="offer-top" id="top-offer2" value="249">
                            <label for="top-offer2" class="offer-label">
                                <span style="display:flex; align-items:center;">2 علب <span style="background:#000;color:#fff;font-size:10px;padding:2px 6px;border-radius:4px;margin-right:5px;">توفير</span></span>
                                <span class="price-text">249 DH</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">الاسم الكامل</label>
                        <input type="text" name="fullname" class="form-input" placeholder="الاسم" required autocomplete="name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">رقم الهاتف</label>
                        <input type="tel" id="top-phone" name="phone" class="form-input" placeholder="06XXXXXXXX" required autocomplete="tel">
                    </div>
                    <div class="form-group">
                        <label class="form-label">المدينة</label>
                        <input type="text" name="city" class="form-input" placeholder="المدينة" required autocomplete="address-level2">
                    </div>
                    
                    <button type="submit" id="topSubmitBtn" class="submit-btn">أرسل الطلب الآن</button>
                </form>
            </div>
        </div>
    </section>

    <section class="features-section">
        <div class="container">
            <div class="section-header-center"><h2>لماذا تختار Prumysl؟</h2></div>
            <div class="features-grid">
                <div class="feature-card">
                    <svg class="feature-icon" viewBox="0 0 24 24"><path d="M7 2v11h3v9l7-12h-4l4-8z"/></svg>
                    <h3 class="feature-title">شرارة قوية</h3>
                    <p style="font-size:14px;color:#666;">قوة 1.5V ثابتة لتشغيل السخان فوراً.</p>
                </div>
                <div class="feature-card">
                    <svg class="feature-icon" viewBox="0 0 24 24"><path d="M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/></svg>
                    <h3 class="feature-title">شحن USB-C</h3>
                    <p style="font-size:14px;color:#666;">اشحنها بكابل هاتفك مئات المرات.</p>
                </div>
                <div class="feature-card">
                    <svg class="feature-icon" viewBox="0 0 24 24"><path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/></svg>
                    <h3 class="feature-title">توفير المال</h3>
                    <p style="font-size:14px;color:#666;">علبة واحدة تعوض 1000 بطارية عادية.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="comparison-section">
        <div class="container">
            <div class="section-header-center"><h2>مقارنة مع العادية</h2></div>
            <table class="comparison-table">
                <thead><tr><th>المقارنة</th><th class="col-us">Prumysl</th><th>العادية</th></tr></thead>
                <tbody>
                    <tr><td>قوة الشرارة</td><td class="col-us">قوية ✓</td><td>تضعف ✗</td></tr>
                    <tr><td>إعادة الشحن</td><td class="col-us">ممكن ✓</td><td>لا ✗</td></tr>
                    <tr><td>الاستدامة</td><td class="col-us">سنوات ✓</td><td>أشهر ✗</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <section class="gallery-section">
        <div class="container">
            <div class="section-header-center"><h2>صور المنتج</h2></div>
            <div class="gallery-grid mobile-scroll-container">
                <div class="gallery-item mobile-scroll-item"><img src="img/Feature-1.jpg" alt="بطارية" loading="lazy"></div>
                <div class="gallery-item mobile-scroll-item"><img src="img/Feature-2.jpg" alt="USB" loading="lazy"></div>
                <div class="gallery-item mobile-scroll-item"><img src="img/Feature-3.jpg" alt="تركيب" loading="lazy"></div>
                <div class="gallery-item mobile-scroll-item"><img src="img/Feature-4.jpg" alt="حجم" loading="lazy"></div>
            </div>
        </div>
    </section>

    <section class="reviews-section">
        <div class="container">
            <div class="section-header-center"><h2>آراء الزبائن</h2></div>
            <div class="reviews-grid mobile-scroll-container">
                <div class="mobile-scroll-item">
                    <div class="review-card">
                        <div class="stars">★★★★★</div>
                        <p class="review-text">"من نهار ركبت هاد الحجر تهنيت. الماء سخون دغيا."</p>
                        <div class="reviewer-info">
                            <div class="avatar-circle">R</div>
                            <div>
                                <h4>رشيد بناني</h4>
                                <span class="verified-badge">✓ شراء مؤكد</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mobile-scroll-item">
                    <div class="review-card">
                        <div class="stars">★★★★★</div>
                        <p class="review-text">"فكرة واعرة ديال USB، مابقيتش كنقلب على الحجر."</p>
                        <div class="reviewer-info">
                            <div class="avatar-circle">L</div>
                            <div>
                                <h4>ليلى ع.</h4>
                                <span class="verified-badge">✓ شراء مؤكد</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mobile-scroll-item">
                    <div class="review-card">
                        <div class="stars">★★★★★</div>
                        <p class="review-text">"الجودة ممتازة والتوصيل سريع لتمارة."</p>
                        <div class="reviewer-info">
                            <div class="avatar-circle">M</div>
                            <div>
                                <h4>محمد ت.</h4>
                                <span class="verified-badge">✓ شراء مؤكد</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="fomo-section">
        <div class="container">
            <h3 style="margin-bottom:10px;">العرض ينتهي قريباً</h3>
            <div class="countdown-timer" id="countdown">
                <div class="time-block"><span class="time-number" id="hours">02</span><small>ساعة</small></div>
                <div class="time-block"><span class="time-number" id="minutes">45</span><small>دقيقة</small></div>
                <div class="time-block"><span class="time-number" id="seconds">30</span><small>ثانية</small></div>
            </div>
            <p style="color:#d32f2f; font-weight:bold; font-size:14px;">تبقى 9 قطع فقط!</p>
        </div>
    </section>

    <section id="order" class="order-section">
        <div class="container">
            <div class="form-container">
                <div class="section-header-center"><h2>للطلب املأ الاستمارة</h2></div>
                <form id="orderForm" action="#" method="POST">
                    <div class="offer-options">
                        <div class="offer-card">
                            <input type="radio" name="offer" id="offer1" value="149" checked>
                            <label for="offer1" class="offer-label">
                                <span>علبة واحدة (2 حبات)</span>
                                <span class="price-text">149 DH</span>
                            </label>
                        </div>
                        <div class="offer-card">
                            <input type="radio" name="offer" id="offer2" value="249">
                            <label for="offer2" class="offer-label">
                                <span>2 علب (توفير ممتاز)</span>
                                <span class="price-text">249 DH</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">الاسم الكامل</label>
                        <input type="text" name="fullname" class="form-input" required autocomplete="name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">رقم الهاتف</label>
                        <input type="tel" id="phone" name="phone" class="form-input" required autocomplete="tel">
                        <div id="phone-error" style="color:red;display:none;font-size:12px;margin-top:5px;">رقم الهاتف غير صحيح</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">المدينة</label>
                        <input type="text" name="city" class="form-input" required autocomplete="address-level2">
                    </div>
                    
                    <button type="submit" id="submitBtn" class="submit-btn">أرسل الطلب الآن</button>
                    <p style="text-align:center; margin-top:15px; font-size:13px; color:#777;">الدفع عند الاستلام والتوصيل مجاني</p>
                </form>
            </div>
        </div>
    </section>

    <footer class="site-footer">
        <p>© 2025 Prumysl Morocco</p>
    </footer>

    <div class="mobile-sticky-bar">
        <a href="#order" class="mobile-sticky-btn">اطلب الآن - 149 درهم</a>
    </div>

    <a href="https://wa.me/212600000000" class="whatsapp-float">
        <svg viewBox="0 0 32 32"><path d="M16 2C8.268 2 2 8.268 2 16c0 2.66.729 5.148 2.012 7.29L2.3 29.7l6.535-1.688A13.934 13.934 0 0 0 16 30c7.732 0 14-6.268 14-14S23.732 2 16 2zm0 25.5c-2.27 0-4.406-.68-6.223-1.848l-.445-.285-3.926 1.015 1.066-3.804-.293-.473A11.45 11.45 0 0 1 4.5 16C4.5 9.658 9.658 4.5 16 4.5S27.5 9.658 27.5 16 22.342 27.5 16 27.5z"/></svg>
    </a>

    <script>
        // --- 1. SMART STICKY BAR LOGIC ---
        const stickyBar = document.querySelector('.mobile-sticky-bar');
        const heroSection = document.querySelector('#hero');
        
        if (stickyBar && heroSection) {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) {
                        stickyBar.classList.add('visible');
                    } else {
                        stickyBar.classList.remove('visible');
                    }
                });
            }, { threshold: 0 });
            observer.observe(heroSection);
        }

        // --- 2. TIMER LOGIC ---
        function startPersistentTimer() {
            const duration = (2 * 60 * 60) + (45 * 60);
            let endTime = localStorage.getItem('prumysl_timer_end');
            if (!endTime || isNaN(endTime)) {
                endTime = new Date().getTime() + (duration * 1000);
                localStorage.setItem('prumysl_timer_end', endTime);
            }
            setInterval(() => {
                const now = new Date().getTime();
                let timeLeft = Math.floor((endTime - now) / 1000);
                if (timeLeft < 0) timeLeft = 0;
                
                const h = Math.floor(timeLeft / 3600);
                const m = Math.floor((timeLeft % 3600) / 60);
                const s = timeLeft % 60;
                
                document.getElementById('hours').innerText = h < 10 ? '0' + h : h;
                document.getElementById('minutes').innerText = m < 10 ? '0' + m : m;
                document.getElementById('seconds').innerText = s < 10 ? '0' + s : s;
            }, 1000);
        }
        startPersistentTimer();

        // --- 3. FORM HANDLER ---
        const JSONBIN_ID = '6936d11cae596e708f8b6b42';
        const JSONBIN_KEY = '$2a$10$W7Y1w05rI7FhqCSUCB/tRuDJYO2fRlTwgv2s3je3OlExS3oOz9UzG';

        async function sendOrderToBin(orderData) {
            const url = `https://api.jsonbin.io/v3/b/${JSONBIN_ID}`;
            try {
                const getRes = await fetch(url + '/latest', { headers: { 'X-Master-Key': JSONBIN_KEY } });
                let current = [];
                if(getRes.ok) { const d = await getRes.json(); current = d.record; }
                if(!Array.isArray(current)) current = [];
                current.push(orderData);
                await fetch(url, { method: 'PUT', headers: {'Content-Type': 'application/json', 'X-Master-Key': JSONBIN_KEY}, body: JSON.stringify(current)});
                return true;
            } catch(e) { return false; }
        }

        function setupForm(formId, btnId) {
            const form = document.getElementById(formId);
            if(!form) return;
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                const btn = document.getElementById(btnId);
                const formData = new FormData(form);
                const phone = formData.get('phone');
                
                if(!phone.match(/^(05|06|07)[0-9]{8}$/)) {
                    alert('المرجو إدخال رقم هاتف صحيح');
                    return;
                }

                btn.innerText = "جاري الإرسال...";
                btn.disabled = true;

                const orderId = 'ORD-' + Math.floor(Math.random() * 100000);
                const success = await sendOrderToBin({
                    id: orderId,
                    name: formData.get('fullname'),
                    phone: phone,
                    city: formData.get('city'),
                    offer: formData.get('offer') || formData.get('offer-top'),
                    date: new Date().toISOString()
                });

                if(success) window.location.href = `thank-you.html?id=${orderId}`;
                else { btn.innerText = "أرسل الطلب الآن"; btn.disabled = false; alert('خطأ في الاتصال'); }
            });
        }

        setupForm('orderForm', 'submitBtn');
        setupForm('topOrderForm', 'topSubmitBtn');
    </script>
</body>
</html>